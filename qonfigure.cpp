#include "qonfigure.h"
#include "ui_qonfigure.h"

Qonfigure::Qonfigure(QWidget *parent) :
    QMainWindow(parent),
    ui(new Ui::Qonfigure)
{
    ui->setupUi(this);

    m_pages = new myTabPage[4];
    ui->devices->addTab(&m_pages[0], "New Device");
    ui->devices->addTab(&m_pages[1], "New Device");
    ui->devices->addTab(&m_pages[2], "New Device");
    ui->devices->addTab(&m_pages[3], "New Device");
}

Qonfigure::~Qonfigure()
{
    delete ui;
}

void Qonfigure::on_actionNew_Device_triggered()
{
    ui->devices->addTab(new myTabPage(), "New Device");
}

void Qonfigure::removeTab(int index)
{
    ui->devices->removeTab(index);
}

void Qonfigure::on_actionSave_triggered()
{
    int n = ui->devices->count();

    QFile file ("/home/viranch/timerconfig.h");
    if (!file.open(QIODevice::WriteOnly | QIODevice::Text))
        return;
    QTextStream out (&file);
    out << "/************************Automatically generated by Qonfigure 0.1****************************/\n\n";

    QString prefix;

    for (int i=0; i<4; i++) {
        if (i==0) prefix = "ONE";
        else if (i==1) prefix = "TWO";
        else if (i==2) prefix = "THREE";
        else if (i==3) prefix = "FOUR";

        out << "/********* Device " << i+1 << "************/\n";
        out << "#define DEV_" << prefix << "_CommonSignal\t\t\t" << m_pages[i].getCommonSignal() << "\n";
    }
    file.close();
}
